{
    "collab_server" : "",
    "contents" : "---\ntitle: \"ImmSig_Anno_example\"\nauthor: \"EH\"\ndate: \"April 4, 2017\"\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n\n```{r set-options, include=FALSE}\nlibrary(ImmuneSpaceR)\nlibrary(org.Hs.eg.db)\nlibrary(data.table)\n```\n\nLet first read the annotation file provided by Yale\n\n```{r}\ndt <- fread(\"Yale_Anno.tsv\", skip = 1, header = FALSE)\ndt[, V1 := NULL]\nsetnames(dt, c(\"PROBE\", \"ALIAS\"))\n# Replace blanks with NAs\ndt[ALIAS == \"\", ALIAS := NA]\n```\n\nthen we will remap all gene names (aliases) in the file above to official gene symbols using Bioconductor's annotation package, which basically add a SYMBOL column to the table above\n```{r}\nstd <- data.table(select(org.Hs.eg.db, keys = keys(org.Hs.eg.db, keytype = \"SYMBOL\"), columns = c(\"ALIAS\", \"SYMBOL\"), keytype = \"SYMBOL\"))\nsetkey(dt, \"ALIAS\")\nsetkey(std, \"ALIAS\")\ndt2 <- merge(dt, std)\n```\n\nWe can now read the GMT files containing the module information, to see if some of the remapping would affect genes in the modules\n\n```{r}\nlibrary(GSEABase)\nbtm <- getGmt(\"./BTM_for_GSEA_20131008.gmt\")\nbtm_list <- geneIds(btm)\ndt_btm <- rbindlist(lapply(btm_list, data.table), idcol = \"module\")\nsetnames(dt_btm, \"V1\", \"ALIAS\")\n```\n\nlet's now remap the gene names (aliases) in the module to official gene symbols\n\n```{r}\nsetkey(dt_btm, \"ALIAS\")\ndt_btm <- merge(dt_btm, std)\n```\n\nnow let's look at different aliases in the original Yale file that would be remapped to the same gene symbol and are in some of the modules\n\n```{r}\n# Looks at duplicated symbol mapping to different aliases\nSY <- dt2[!duplicated(ALIAS) & duplicated(SYMBOL), SYMBOL]\n# Look at affected modules\ndt_btm[SYMBOL %in% SY]\n```\n\nand in particular it affects some of the significant modules reported in the immune signature paper, such as M118.1\n\n```{r}\ndt_btm[SYMBOL %in% SY & module %like% \"M118.1\"]\n```\n\nand let's go back to the original Yale mapping\n\n```{r}\ndt2[SYMBOL %in% dt_btm[SYMBOL %in% SY & module %like% \"M118.1\", SYMBOL]]\n```\n\non the table above, it can be seen that some of the gene names in the original mapping such as AGPAT9 and LPCAT1 correspond to the same gene (LPCAT1), but the gene expression calculation (maximum over probe) treated them differently. \n\n\n\n",
    "created" : 1491595394053.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "334993224",
    "id" : "8BE2BEED",
    "lastKnownWriteTime" : 1491409867,
    "last_content_update" : 1491409867,
    "path" : "~/Desktop/ImmSig_Anno_example_RG.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}